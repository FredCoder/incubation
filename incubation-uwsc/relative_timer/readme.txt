Relative Timer ver.1.0.0.20171009 　　　　　　　　　　　　yk0242/yybtcbk
＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝

■はじめに
本アプリは、開始時間から起算したスケジュールを設定し、設定時間になると
画面上の通知、及びに設定したメールでの通知を行うものです。
以下の詳細に従って、設定・起動を行って下さい。



■事前準備
本アプリの仕様上、ご利用に際しては、以下の設定が必要となります：

Googleアカウントの設定として、
「安全性の低いアプリがアカウントにアクセスするのを許可する」
https://support.google.com/accounts/answer/6010255?hl=ja
から、以下のページに飛び、
https://myaccount.google.com/lesssecureapps
>[安全性の低いアプリのアクセス] の横にある [有効にする] を選択します。

（セキュリティが気になる場合は、本ソフトウェアの使用等の用途用に、
　Googleの別アカウントを取得する事も考えられます。）



■起動手順
1. 同梱ファイルを適当な場所（A）に保存・展開します。
2. 必要なら、UWSCをインストールします。

＞パターンＡ
3a. UWSCの左ボタンから、（A）の「relative_timer.UWS」を読み込みます。
4a. UWSCの真ん中のボタンで一度起動します。

＞パターンＢ
3b. UWSCの実行体（UWSC.exe）を（A）にコピーします。
4b. 同梱の「_start_relative_timer.bat」をダブルクリックで起動します。


■動作手順
5. 初回のみ確認ダイアログが出ますので、
   利用するメールアドレスとパスワードを入力して下さい。
   （メール設定ファイル（relative_timer_gmail.ini）が（A）に作成されます。）
6. 「relative_timer_schedule.ini」が（A）に作成された上で、一度終了します。
   テキストエディタでこのファイルを開き、スケジュールを記入して下さい。
   スケジュールは各行を以下の形式で記入します：
   『「項番」=「hh:mm:ss（開始までの時間）」,「送信メールタイトル」,「送信メール本文」』
   （詳細な記入形式については、次の項目をご確認下さい。）
7. もう一度本アプリを起動すると、スケジューラーが始まります。

5.は正確に入力して下さい。設定ミスがあるとメールが送れません。
（パスワードは簡易的に暗号化されますが、ソフトウェアの仕様上100%安全ではないため、
　メール設定ファイル（relative_timer_gmail.ini）の取り扱いには十分にご注意下さい。
　メールアドレスは現状わざと平文で記載していますが、要望があれば暗号化します。）

6.のスケジュールに関しては、とりあえずデフォルトの物で66秒後、1分42秒後、1時間2分3秒後等に
　簡単なメール通知するので、そのままでも一通りの動作確認が可能となります。



■スケジュールの記入形式について
・項番とその後の情報の間は、半角イコール（=）で区切って下さい。
・項番は時系列順に、1から順に割り振って下さい。
・開始時間、メールタイトル、メール本文の、それぞれの間は、半角カンマ（,）で区切って下さい。
・開始までの時間は、左から 時:分:秒 と表記し、間は半角コロン（:）で区切って下さい。
・メール本文内で改行したい場合は、「<##CR>」と記述して下さい。
・メール本文内、またはメールタイトル内で、半角のカンマ（,）を使いたい場合は、
　該当する部分（メール本文・メールタイトル）全体を、半角ダブルクオーテーション（""）で囲んで下さい。
・区切りの半角カンマ（,）の前後の半角スペースは任意です。
・24時間以上、60分・秒以上の表記にも対応しています。



■設定カスタマイズ
「relative_timer_schedule.ini」の[settings]セクションの値を変更する事で、
以下の設定変更による本アプリのカスタマイズが可能となります：
┌─────────┬──────────┬────────────────────┐
│　　 設定内容 　　│　　 設定項目名 　　│設定値（一番上がデフォルト値）　　　　　│
├─────────┼──────────┼────────────────────┤
│PC上のバルーン表示│display 　　　　　　│1:バルーンを常に表示する　　　　　　　　│
│　　　　　　　　　│　　　　　　　　　　│2:メール発信時のみバルーンを表示する　　│
│　　　　　　　　　│　　　　　　　　　　│0:ログプリントのみ　　　　　　　　　　　│
├─────────┼──────────┼────────────────────┤
│　メール送信の有無│email 　　　　　　　│1:メールを飛ばす　　　　　　　　　　　　│
│　　　　　　　　　│　　　　　　　　　　│0:メールを飛ばさない　　　　　　　　　　│
├─────────┼──────────┼────────────────────┤
│　　差分開始の使用│use_shifted_start 　│1:使用する：起動時に差分時間を入力　　　│
│　　　　　　　　　│　　　　　　　　　　│0:使用しない：起動時に起算開始　　　　　│
├─────────┼──────────┼────────────────────┤
│　開始時間前の扱い│suppress_past_events│1:開始時点で過ぎているスケジュールは無視│
│　　　　　　　　　│　　　　　　　　　　│0:無視せず処理　　　　　　　　　　　　　│
├─────────┼──────────┼────────────────────┤
│　　通常バルーン色│balloon_color1　　　│(RGB) 　　　　　　　　　　　　　　　　　│
├─────────┼──────────┼────────────────────┤
│　　送信バルーン色│balloon_color2　　　│(RGB) 　　　　　　　　　　　　　　　　　│
├─────────┼──────────┼────────────────────┤
│　　灰色バルーン色│balloon_color3　　　│(RGB) 　　　　　　　　　　　　　　　　　│
└─────────┴──────────┴────────────────────┘



■課題点
・スケジュール設定が手動で面倒：
　　とりあえず現状のままリリースしてみて、要望があれば設定ツールの作成を検討します。



■動作確認環境
OS：Windows10（開発環境）
　　Windows7 （動作確認）

UWSC：ver.5.3.0.2（開発環境）



■免責事項など
本アプリのご利用により何らかの不利益が生じた場合、
当方では一切の責任を負いかねますので、悪しからずご了承下さい。

本アプリは、同梱のMITライセンスの範囲内での再利用・再配布を可能とします。

本ソフトウェアの最新のソースコードは、暗号化モジュールを例外に、
以下のGitHubページにて公開しています：
https://github.com/yk0242/incubation/tree/master/incubation-uwsc/relative_timer/

以下のどちらにでも、要望・不具合報告・感想などを頂けると、作者が喜びます：
 e-mail： yybtcbk@gmail.com
twitter： https://twitter.com/kitamiya


[EOF]
